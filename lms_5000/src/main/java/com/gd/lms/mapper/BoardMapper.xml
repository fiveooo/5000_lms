<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gd.lms.mapper.BoardMapper">

	<!-- 게시판 리스트 생성 쿼리 -->
	<select id="selectBoradList" resultType="com.gd.lms.vo.Board">
		select 
			board_no boardNo
			, board_name boardName
			, board_type boardType
			, create_date createDate
			, lecture_no lectureNo		
		from board b
		where b.lecture_no = #{lectureNo}	
	</select>
		
	<!-- 게시판 생성 쿼리 -->
	<insert id="insertBoard" parameterType="com.gd.lms.vo.Board">
		insert
			into board (
				board_name
				, board_type
				, create_date
				, lecture_no
			) values (
				#{boardName}
				, 3
				, now()
				, #{lectureNo}
			)
	</insert>
	
	
	<!-- 선택한 게시판의 게시글 리스트 생성 쿼리 -->
	<select id="selectBoardPostList" resultType="com.gd.lms.vo.BoardPost">
		select
			board_post_no boardPostNo
			, board_no boardNo
			, board_post_Title boardPostTitle
			, board_post_content boardPostContent
			, board_post_writer boardPostWriter
			, board_post_createdate boardPostCreatedate
			, board_post_updatedate boardPostUpdatedate
			, count count
		from board_post
		where board_No = #{boardNo}
	</select>

	
	<!-- 게시글 상세 조회 쿼리 -->
	<select id="selectBoardPostOne" resultType="map">
		select
			p.board_post_no boardPostNo
			, p.board_no boardNo
			, p.board_post_Title boardPostTitle
			, p.board_post_content boardPostContent
			, p.board_post_writer boardPostWriter
			, p.board_post_createdate boardPostCreatedate
			, p.board_post_updatedate boardPostUpdatedate
			, p.count count
			, f.file_originname fileOriginname
			, f.file_name fileName
		from board_post p 
		inner join board_file f
		on p.board_post_no = f.board_post_no
		where p.board_post_no = #{boardPostNo}
	</select>
	
	
	<!-- 게시글 추가 쿼리 -->
	<insert id="insertBoardPost" parameterType="com.gd.lms.vo.BoardPost" useGeneratedKeys="true" keyProperty="boardPostNo">
		insert
			into board_post(
				board_no
				, board_post_title
				, board_post_content
				, board_post_writer
				, board_post_createdate
				, board_post_updatedate
				, count
			) values (
				#{boardNo}
				, #{boardPostTitle}
				, #{boardPostContent}			
				, #{boardPostWriter}
				, now()
				, now()
				, 0			
			)
	</insert>
	
	
	<!-- 게시글 추가 쿼리 -->
	<insert id="insertBoardFile" parameterType="com.gd.lms.vo.BoardFile">
		insert
			into board_file(
				file_name
				, file_originname
				, file_type
				, create_date
				, board_post_no
			) values (
				#{fileName}
				, #{fileOriginname}			
				, #{fileType}
				, now()
				, #{boardPostNo}
			)
	</insert>
	
	



</mapper>