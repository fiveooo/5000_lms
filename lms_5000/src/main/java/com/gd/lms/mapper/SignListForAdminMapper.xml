<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gd.lms.mapper.SignListForAdminMapper">
	<!--  강좌 리스트 -->
	<select id="selectLectureList" resultType="map">
		SELECT 
			l.lecture_no,
			l.classroom_no,
			s.subject_name,
			s.subject_grade
		FROM lecture l INNER JOIN subject s ON l.subject_no = s.subject_no
		WHERE l.lecture_no
	</select>
	
	<!-- 강좌별 수강신청 인원 -->
	<select id="selectStudentListByLecture" resultType="map" parameterType="com.gd.lms.vo.Sign">
		SELECT
			l.lecture_no,
			s.subject_name,
			s.subject_grade,
			i.sign_state,
			m.major_name,
			t.user_id,
			t.st_name
		FROM lecture l INNER JOIN subject s ON l.subject_no = s.subject_no
		INNER JOIN sign i ON l.lecture_no = i.lecture_no
		INNER JOIN student t ON i.user_id = t.user_id
		INNER JOIN major m ON t.major_no = m.major_no
		WHERE l.lecture_no = #{lectureNo}
	</select>
	
	<!-- 학생 수강 상태 변경 -->
	<update id="updateSignState" parameterType="com.gd.lms.vo.Sign">
		UPDATE sign
		SET sign_state = #{signState}
		WHERE lecture_no = #{lectureNo} 
		AND user_id = #{userId}
	</update>
</mapper>